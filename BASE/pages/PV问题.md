## 1. 化学键合成问题
	- **资源**：有两种线程，一种是氢原子（H），一种是氧原子（O）。
	- **规则**：
		- 要合成一个 $H_2O$ 分子，必须有 **2 个 H 线程**和 **1 个 O 线程**到达。
		- 在合成（调用 `bond()` 函数）之前，这三个线程必须**同时凑齐**。
		- 如果只有两个 H 到达，它们必须等 O；如果只有 O 到达，它必须等两个 H。
		- **难点**：必须保证每 3 个原子一组准确合成，不能出现两个 O 抢了四个 H 却乱序合成的情况。
		  **请写出 H 线程和 O 线程的 P/V 伪代码。**
	- 信号量包含：
		- 一个整数值
		- 一个等待队列
	- ```
	  int get_H = 0;
	  H: begin
	  	V(get_H);
	  O: begin
	  	P(get_H);
	      P(get_H);
	      bond();
	  ```
		- 存在的问题：
			- “幽灵氢原子”问题 (The Ghost H Problem)
			- “资源抢占”与“成组分配” (The Grouping Problem)
		- 解决：
			- 引入屏障同步
		- ```
		  int h_count = 0, o_count = 0;
		  int mutex = 1, h_sem = 0, o_sem = 0, barrier = 0;
		  H: begin
		  	P(mutex)
		      h_count++;
		      if(h_count >= 2 && o_count >= 1) {
		      	V(h_sem);
		          h_count -= 2;
		          V(o_sem);
		          o_count -= 1;
		          V(mutex);
		      }
		      else {
		      	V(mutex);
		          P(h_sem);
		      }
		      bond();
		      V(barrier);
		      
		  ```
- ## 圣诞老人问题
	- 这是由 John Trono 在 1994 年提出的极高难度同步问题。
	- **角色**：圣诞老人（Santa）、九只驯鹿（Reindeer）、三名小矮人（Elves）。
	- **规则**：
		- 圣诞老人在北极睡觉。他只会被以下两种情况唤醒：
			- **情况 A**：全部 **9 只驯鹿**都度假回来了（它们必须全部到齐，圣诞老人才能去送礼物）。
			- **情况 B**：有 **3 名小矮人**在工作上遇到了困难（他们必须凑够 3 个人才能去打扰圣诞老人）。
		- **优先级**：如果 9 只驯鹿和 3 名小矮人同时准备好，圣诞老人必须**先服务驯鹿**（送礼物比解决技术问题更紧急）。
		- 小矮人如果少于 3 个，只能在门口等，不能去唤醒圣诞老人。
		- 当圣诞老人解决完 3 个小矮人的问题后，这 3 个小矮人离开，其他等待的小矮人才能进入。
	- ```
	  int reindeer_count = 0, elf_count = 0;
	  int mutex = 1;
	  Reindeer: begin
	  	P(mutex)
	      if(reinderr_count == 9) {
	          reindeerr_count -= 9;
	          for(int i=0; i<8; i++) V(deer);
	          V(santa)
	          V(mutex)
	      }
	      else {
	      	P(deer)
	          V(mutex)
	      }
	  
	  Santa: begin
	  	
	  
	  ```
	- 圣诞老人在北极睡觉。但是圣诞节了，他会被唤醒，当全部九只驯鹿都度假回来了，或者有三个小矮人遇到了困难。如果遇到困难的小矮人太少，他们不会去打扰圣诞老人，只在圣诞老人的家门口等。而且如果驯鹿回来了，圣诞老人会先去驾着驯鹿送礼物，不去管小矮人。圣诞老人会同时解决三个小矮人的困难，等三个小矮人离开了，其他的小矮人才能进入。